!function(t){function n(t){if(r[t])return r[t];throw new Error('Cannot find module "'+t+'".')}var r={};r.util={inherits:function(t,n){t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}};var e={nextTick:function(t){setTimeout(t,0)}},i={exports:{}};!function(t,r){function e(t){return t[0].toUpperCase()+t.substr(1)}function i(t,n,r){this.name="BrightFlowError",this.code=t,this.message=n||e(t),Error.captureStackTrace(this,r)}var o=n("util");o.inherits(i,Error),r=t.exports=i,r.TIMEOUT="timeout",r.BREAK="break",r.MULTI_TIMES="multi_times"}(i,i.exports),r["./error"]=i.exports;var i={exports:{}};!function(t,r){function i(){this._returned=!1,this.done=this._done.bind(this),this._data={}}var o=n("./error");r.BaseFlow=i,r.derive=function(t){for(var n in i.prototype)t.prototype[n]=i.prototype[n];t.prototype._super=i},i.prototype._call=function(t,n){return n=n||[],n.push(this),t.apply(this,n)},i.prototype.timeout=function(t){return this._timeout=t,this},i.prototype.break=function(t){var t=arguments.length>0?t:new o(o.BREAK);this._return(t)},i.prototype._assert=function(){if(this._returned)throw new o(o.MULTI_TIMES,"callback() has been called")},i.prototype._return=function(t){this._assert(),t=t||null,this._tid&&clearTimeout(this._tid);var n=this._data.callback;this._returned=!0,this.destroy(),n(t)},i.prototype.destroy=function(){this._data=null},i.prototype._start=function(t,n){var r=this;return this._data.callback=n,r._timeout>0&&(this._tid=setTimeout(function(){r._return(new o(o.TIMEOUT))},r._timeout)),e.nextTick(t),this}}(i,i.exports),r["./flow"]=i.exports;var i={exports:{}};!function(t,r){function e(t){return this instanceof e?(this._super(),this._data.cond=[this._formatCond(t)],this._data.fn=[],this._test=this._testCond.bind(this),void 0):new e(t)}var i=n("./flow");r=t.exports=e,i.derive(e),e.prototype._formatCond=function(t){return"function"==typeof t?t.length>0?t:function(n){n(t())}:function(n){n(t)}},e.prototype.then=function(t){return this._data.fn.push(t),this},e.prototype.elseif=function(t){return this._data.cond.push(this._formatCond(t)),this},e.prototype.else=function(t){return this._data.fn.push(t),this},e.prototype._done=function(t){if(this._assert(),t)return this._return(t);if(this._data.test)return this._return();if(this._data.cond.length>0){var n=this._data.cond.shift();n(this._test)}else this._data.fn.length>0?this._call(this._data.fn.shift(),[this.done]):this._return()},e.prototype._testCond=function(t){this._data.test=t,t?this._call(this._data.fn.shift(),[this.done]):(this._data.fn.shift(),this.done())},e.prototype.end=function(t){return this._start(this.done,t),this}}(i,i.exports),r["./if"]=i.exports;var i={exports:{}};!function(t,r){function e(t){return this instanceof e?(this._super(),this._data.cond=t.length>0?t:function(n){n(t())},this._test=this._testCond.bind(this),void 0):new e(t)}var i=n("./flow");r=t.exports=e,i.derive(e),e.prototype.do=function(t){return this._data.fn=t,this},e.prototype._done=function(t){return this._assert(),t?this._return(t):(this._data.cond(this._test),void 0)},e.prototype._testCond=function(t){t?this._call(this._data.fn,[this.done]):this._return()},e.prototype.end=function(t){return this._start(this.done,t),this}}(i,i.exports),r["./for"]=i.exports;var i={exports:{}};!function(t,r){function e(t){if(!(this instanceof e))return new e(t);this._super(),this._data.fn=[],this._data.source=t;var n=this._data.array=[],r=this._data.keys=[];if(Array.isArray(t))for(var i=0;i<t.length;i++)n.push(t[i]),r.push(i);else for(var i in t)n.push(t[i]),r.push(i)}var i=n("./flow");r=t.exports=e,i.derive(e),e.prototype.do=function(t){return this._data.fn=t,this},e.prototype._done=function(t){if(this._assert(),t)return this._return(t);var n=this._data;if(n.index++,n.index<n.length){var r=n.index;this._call(n.fn,[n.array[r],n.keys[r],n.source,this.done])}else this._return()},e.prototype.end=function(t){return this._data.index=-1,this._data.length=this._data.array.length,this._start(this.done,t),this}}(i,i.exports),r["./each"]=i.exports;var i={exports:{}};!function(t,r){function e(){return this instanceof e?(this._super(),this._data.fn=[],void 0):new e}var i=n("./flow");r=t.exports=e,i.derive(e),e.prototype.do=function(t){return this._data.fn.push(t),this},e.prototype._done=function(t){return this._assert(),t?this._return(t):(this._data.fn.length>0?this._call(this._data.fn.shift(),[this.done]):this._return(),void 0)},e.prototype.end=function(t){return this._start(this.done,t),this}}(i,i.exports),r["./series"]=i.exports;var i={exports:{}};!function(t,r){function i(){return this instanceof i?(this._super(),this._data.fn=[],void 0):new i}var o=n("./flow");r=t.exports=i,o.derive(i),i.prototype.do=function(t){return this._data.fn.push(t),this},i.prototype._done=function(t){if(!this._ignoreAll){if(this._assert(),t)return this._return(t);this._doneCount++,this._doneCount>=this._taskCount&&this._return()}},i.prototype.end=function(t){var n=this;return this._doneCount=0,this._taskCount=this._data.fn.length,this._start(function(){n._data.fn.forEach(function(t){e.nextTick(function(){n._call(t,[n.done])})})},function(r){r&&(n._ignoreAll=!0),t(r)}),this}}(i,i.exports),r["./parallel"]=i.exports;var i={exports:{}};!function(t,r){r.if=n("./if"),r.for=n("./for"),r.each=n("./each"),r.series=n("./series"),r.parallel=n("./parallel"),r.BrightFlowError=n("./error")}(i,i.exports),r["./index"]=i.exports,t.brightFlow=n("./index")}(window);